repeat task.wait() until game:IsLoaded()

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local map = workspace:WaitForChild("MAP")

-- Events
local coinEvent = ReplicatedStorage:WaitForChild("Events"):WaitForChild("CoinEvent")
local hitEvent = ReplicatedStorage:WaitForChild("jdskhfsIIIllliiIIIdchgdIiIIIlIlIli")

-- Flags
local autoCoins = false
local autoDummy = false
local auto5kDummy = false
local autoDoubleDummy = false

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = "GhoulzHub"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 320, 0, 320)
main.Position = UDim2.new(0.5, -160, 0.5, -160)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
main.BorderColor3 = Color3.fromRGB(255, 0, 0)
main.Active = true

local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, 0, 0, 35)
title.BackgroundColor3 = Color3.fromRGB(50, 0, 0)
title.Text = "Ghoulz Hub"
title.TextScaled = true
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.new(1, 1, 1)

-- Boutons
local function makeBtn(y, text)
	local btn = Instance.new("TextButton", main)
	btn.Size = UDim2.new(0, 230, 0, 40)
	btn.Position = UDim2.new(0.5, -115, 0, y)
	btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
	btn.Text = text
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.Font = Enum.Font.GothamBold
	btn.TextScaled = true
	return btn
end

local btnCoins = makeBtn(50, "Auto Coins: OFF")
local btnDummy = makeBtn(100, "Auto Dummy: OFF")
local btn5k = makeBtn(150, "Auto 5k Dummy: OFF")
local btnDouble = makeBtn(200, "Auto Double Dummy: OFF")
local closeBtn = makeBtn(260, "Fermer")
closeBtn.BackgroundColor3 = Color3.fromRGB(120, 0, 0)

-- Drag system
local dragging, dragStart, startPos
main.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = main.Position
	end
end)
main.InputChanged:Connect(function(input)
	if dragging and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement) then
		local delta = input.Position - dragStart
		main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)
main.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = false
	end
end)

-- üß† Auto-hit init (simulate first hit)
local function simulateFirstHit()
	task.spawn(function()
		local folder5k = map:FindFirstChild("5k_dummies")
		if folder5k and #folder5k:GetChildren() > 0 then
			local dummy = folder5k:GetChildren()[1]
			local hum = dummy:FindFirstChild("Humanoid")
			if hum then
				pcall(function()
					hitEvent:FireServer(hum, 1)
				end)
			end
		end
	end)
end

-- ‚öôÔ∏è Auto Coins
local function runAutoCoins()
	while autoCoins do
		pcall(function()
			coinEvent:FireServer()
		end)
		task.wait(0.2)
	end
end

-- ‚öôÔ∏è Auto Dummy (dossier "dummies")
local function runAutoDummy()
	local folder = map:WaitForChild("dummies")
	while autoDummy do
		for _, dummy in ipairs(folder:GetChildren()) do
			local hum = dummy:FindFirstChild("Humanoid")
			if hum then
				pcall(function()
					hitEvent:FireServer(hum, math.huge)
				end)
			end
		end
		task.wait(0.1)
	end
end

-- ‚öôÔ∏è Auto 5k Dummy (dossier "5k_dummies")
local function runAuto5kDummy()
	local folder = map:WaitForChild("5k_dummies")
	while auto5kDummy do
		for _, dummy in ipairs(folder:GetChildren()) do
			local hum = dummy:FindFirstChild("Humanoid")
			if hum then
				pcall(function()
					hitEvent:FireServer(hum, math.huge)
				end)
			end
		end
		task.wait(0.1)
	end
end

-- ‚öôÔ∏è Auto Double Dummy (tp sur un seul dummy, frappe les deux types)
local function runAutoDoubleDummy()
	local folder5k = map:WaitForChild("5k_dummies")
	local folderNormal = map:WaitForChild("dummies")
	while autoDoubleDummy do
		local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
		if hrp then
			-- choisir un dummy 5k pour TP
			local dummy5k = folder5k:GetChildren()[math.random(1, #folder5k)]
			if dummy5k and dummy5k:FindFirstChild("HumanoidRootPart") then
				hrp.CFrame = dummy5k.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
			end

			-- Frapper tous les dummies 5k et normaux
			for _, d in ipairs(folder5k:GetChildren()) do
				local hum = d:FindFirstChild("Humanoid")
				if hum then
					pcall(function()
						hitEvent:FireServer(hum, math.huge)
					end)
				end
			end
			for _, d in ipairs(folderNormal:GetChildren()) do
				local hum = d:FindFirstChild("Humanoid")
				if hum then
					pcall(function()
						hitEvent:FireServer(hum, math.huge)
					end)
				end
			end
		end
		task.wait(0.2)
	end
end

-- üü¢ Boutons ON/OFF
btnCoins.MouseButton1Click:Connect(function()
	autoCoins = not autoCoins
	btnCoins.Text = "Auto Coins: " .. (autoCoins and "ON" or "OFF")
	btnCoins.BackgroundColor3 = autoCoins and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(60, 60, 60)
	if autoCoins then task.spawn(runAutoCoins) end
end)

btnDummy.MouseButton1Click:Connect(function()
	autoDummy = not autoDummy
	btnDummy.Text = "Auto Dummy: " .. (autoDummy and "ON" or "OFF")
	btnDummy.BackgroundColor3 = autoDummy and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(60, 60, 60)
	if autoDummy then task.spawn(runAutoDummy) end
end)

btn5k.MouseButton1Click:Connect(function()
	auto5kDummy = not auto5kDummy
	btn5k.Text = "Auto 5k Dummy: " .. (auto5kDummy and "ON" or "OFF")
	btn5k.BackgroundColor3 = auto5kDummy and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(60, 60, 60)
	if auto5kDummy then task.spawn(runAuto5kDummy) end
end)

btnDouble.MouseButton1Click:Connect(function()
	autoDoubleDummy = not autoDoubleDummy
	btnDouble.Text = "Auto Double Dummy: " .. (autoDoubleDummy and "ON" or "OFF")
	btnDouble.BackgroundColor3 = autoDoubleDummy and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(60, 60, 60)
	if autoDoubleDummy then task.spawn(runAutoDoubleDummy) end
end)

closeBtn.MouseButton1Click:Connect(function()
	autoCoins = false
	autoDummy = false
	auto5kDummy = false
	autoDoubleDummy = false
	gui:Destroy()
end)

-- üî• Auto-init du premier coup
simulateFirstHit()
